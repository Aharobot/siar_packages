<?xml version="1.0"?>
<launch>

  <arg name="resolution" default="0.025"/>
  <arg name="obstacle_height" default="0.05"/>
  <arg name="camera_1" default="/front_down"/>
  <arg name="camera_2" default="/back_down"/>
  <arg name="camera_3" default="/front_down_2"/>
  <arg name="camera_4" default="/back"/>
  <arg name="tilt_compensate" default="true"/>
  <arg name="roi_x" default="-1"/>
  <arg name="roi_y" default="-1"/>
  <arg name="roi_w" default="-1"/>
  <arg name="roi_h" default="-1"/>
  
  # Point cloud computation
  <node pkg="depth2cloud" type="depth2cloud_node" name="depth2cloud_front_down" output="screen" >
    <remap from="depth" to="$(arg camera_1)/depth_registered/image_raw"/>                   # Topic for the camera depth
    <remap from="info" to="$(arg camera_1)/depth_registered/camera_info"/>                  # Topic for the camera info
    <remap from="cloud" to="$(arg camera_1)/point_cloud"/>                                                  # Topic name for output point cloud
    <param name="range_min" value = "0.3"/>                                                                     # Min range in meters for point cloud generation
    <param name="range_max" value = "3.0"/>                                                                     # Max range in meters for point cloud generation
    <param name="down_sampling" value = "1"/>                                                           # Camera down sampling factor. Values: 1, 2 or 4. The bigger the faster.
    <param name="roi_x" value="$(arg roi_x)"/>
    <param name="roi_y" value="$(arg roi_y)"/>
    <param name="roi_w" value="$(arg roi_w)"/>
    <param name="roi_h" value="$(arg roi_h)"/>
  </node>
  <node pkg="depth2cloud" type="depth2cloud_node" name="depth2cloud_back_down" output="screen" >
    <remap from="depth" to="$(arg camera_2)/depth_registered/image_raw"/>                    # Topic for the camera depth
    <remap from="info" to="$(arg camera_2)/depth_registered/camera_info"/>                   # Topic for the camera info
    <remap from="cloud" to="$(arg camera_2)/point_cloud"/>                                                   # Topic name for output point cloud
    <param name="range_min" value = "0.3"/>                                                                     # Min range in meters for point cloud generation
    <param name="range_max" value = "3.0"/>                                                                     # Max range in meters for point cloud generation
    <param name="down_sampling" value = "1"/>                                                           # Camera down sampling factor. Values: 1, 2 or 4. The bigger the faster.
    <param name="roi_x" value="$(arg roi_x)"/>
    <param name="roi_y" value="$(arg roi_y)"/>
    <param name="roi_w" value="$(arg roi_w)"/>
    <param name="roi_h" value="$(arg roi_h)"/>
  </node>
  <node pkg="depth2cloud" type="depth2cloud_node" name="depth2cloud_front_down_2" output="screen" >
    <remap from="depth" to="$(arg camera_3)/depth_registered/image_raw"/>                    # Topic for the camera depth
    <remap from="info" to="$(arg camera_3)/depth_registered/camera_info"/>                   # Topic for the camera info
    <remap from="cloud" to="$(arg camera_3)/point_cloud"/>                                                   # Topic name for output point cloud
    <param name="range_min" value = "0.3"/>                                                                     # Min range in meters for point cloud generation
    <param name="range_max" value = "3.0"/>                                                                     # Max range in meters for point cloud generation
    <param name="roi_x" value="$(arg roi_x)"/>
    <param name="roi_y" value="$(arg roi_y)"/>
    <param name="roi_w" value="$(arg roi_w)"/>
    <param name="roi_h" value="$(arg roi_h)"/>
    <param name="down_sampling" value = "1"/>                                                           # Camera down sampling factor. Values: 1, 2 or 4. The bigger the faster.
  </node>
  <node pkg="depth2cloud" type="depth2cloud_node" name="depth2cloud_4" output="screen" >
    <remap from="depth" to="$(arg camera_4)/depth_registered/image_raw"/>                    # Topic for the camera depth
    <remap from="info" to="$(arg camera_4)/depth_registered/camera_info"/>                   # Topic for the camera info
    <remap from="cloud" to="$(arg camera_4)/point_cloud"/>                                                   # Topic name for output point cloud
    <param name="range_min" value = "0.3"/>                                                                     # Min range in meters for point cloud generation
    <param name="range_max" value = "3.0"/>                                                                     # Max range in meters for point cloud generation
    <param name="roi_x" value="$(arg roi_x)"/>
    <param name="roi_y" value="$(arg roi_y)"/>
    <param name="roi_w" value="$(arg roi_w)"/>
    <param name="roi_h" value="$(arg roi_h)"/>
    <param name="down_sampling" value = "1"/>                                                           # Camera down sampling factor. Values: 1, 2 or 4. The bigger the faster.
  </node>
  
  <node pkg="siar_costmap" type="costmap_node" name="costmap_node" output="screen" >
    <remap from="cloud0" to="$(arg camera_1)/point_cloud"/>                 # Input cloud 0
    <remap from="cloud1" to="$(arg camera_2)/point_cloud"/>                  # Input cloud 1
    <remap from="cloud2" to="$(arg camera_3)/point_cloud"/>                  # Input cloud 2
    <remap from="cloud3" to="$(arg camera_4)/point_cloud"/>                  # Input cloud 3
    <param name="hz" value = "10.0"/>                                                   # Costmap update rate
    <param name="obstacle_height" value = "$(arg obstacle_height)"/>                               # Absolute value of obstacle height (or hole depth)
    <param name="resolution" value="$(arg resolution)"/>
    <param name="exp_decay" value = "40.0"/>					    # Obstacle exponential decay (it is counted in cells)
    <param name="width" value="1.5"/>
    <param name="height" value="3.0"/>
    <param name="tilt_compensate" value="$(arg tilt_compensate)"/>
    <remap from="imu" to="/arduimu_v3/imu"/>
  </node>

</launch>
  